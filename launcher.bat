::[Bat To Exe Converter]
::
::YAwzoRdxOk+EWAjk
::fBw5plQjdCyDJGyX8VAjFBBbTQiDOHm/D4k47fvw++WXnksUWuMzRJzJ2YieNeIf40bYfJss0X9JpMIPAxVLQhO7fkE9qmEi
::YAwzuBVtJxjWCl3EqQJgSA==
::ZR4luwNxJguZRRnk
::Yhs/ulQjdF+5
::cxAkpRVqdFKZSTk=
::cBs/ulQjdF+5
::ZR41oxFsdFKZSDk=
::eBoioBt6dFKZSDk=
::cRo6pxp7LAbNWATEpCI=
::egkzugNsPRvcWATEpCI=
::dAsiuh18IRvcCxnZtBJQ
::cRYluBh/LU+EWAnk
::YxY4rhs+aU+JeA==
::cxY6rQJ7JhzQF1fEqQJQ
::ZQ05rAF9IBncCkqN+0xwdVs0
::ZQ05rAF9IAHYFVzEqQJQ
::eg0/rx1wNQPfEVWB+kM9LVsJDGQ=
::fBEirQZwNQPfEVWB+kM9LVsJDGQ=
::cRolqwZ3JBvQF1fEqQJQ
::dhA7uBVwLU+EWDk=
::YQ03rBFzNR3SWATElA==
::dhAmsQZ3MwfNWATElA==
::ZQ0/vhVqMQ3MEVWAtB9wSA==
::Zg8zqx1/OA3MEVWAtB9wSA==
::dhA7pRFwIByZRRnk
::Zh4grVQjdCyDJGyX8VAjFBBbTQiDOHm/D4k47fvw++WXnksUWuMzRKPo6oHODeUX40bte5Nt/3RMncUYAwlBPiGyfRsxpCBHrmHl
::YB416Ek+ZG8=
::
::
::978f952a14a936cc963da21a135fa983
::[Bat To Exe Converter]
::
::YAwzoRdxOk+EWAjk
::fBw5plQjdCyDJGyX8VAjFBBbTQiDOHm/D4k47fvw++WXnksUWuMzRJzJ2YieNeIf40bYfJss0X9JpMIPAxVLQhO7fkE9qmEi
::YAwzuBVtJxjWCl3EqQJgSA==
::ZR4luwNxJguZRRnk
::Yhs/ulQjdF+5
::cxAkpRVqdFKZSTk=
::cBs/ulQjdF+5
::ZR41oxFsdFKZSDk=
::eBoioBt6dFKZSDk=
::cRo6pxp7LAbNWATEpCI=
::egkzugNsPRvcWATEpCI=
::dAsiuh18IRvcCxnZtBJQ
::cRYluBh/LU+EWAnk
::YxY4rhs+aU+JeA==
::cxY6rQJ7JhzQF1fEqQJQ
::ZQ05rAF9IBncCkqN+0xwdVs0
::ZQ05rAF9IAHYFVzEqQJQ
::eg0/rx1wNQPfEVWB+kM9LVsJDGQ=
::fBEirQZwNQPfEVWB+kM9LVsJDGQ=
::cRolqwZ3JBvQF1fEqQJQ
::dhA7uBVwLU+EWDk=
::YQ03rBFzNR3SWATElA==
::dhAmsQZ3MwfNWATElA==
::ZQ0/vhVqMQ3MEVWAtB9wSA==
::Zg8zqx1/OA3MEVWAtB9wSA==
::dhA7pRFwIByZRRnk
::Zh4grVQjdCyDJGyX8VAjFBBbTQiDOHm/D4k47fvw++WXnksUWuMzRKPo6oHODeUX40bte5Nt/3RMncUYAwlBPiGyfRsxpCBHrmHl
::YB416Ek+ZG8=
::
::
::978f952a14a936cc963da21a135fa983
::[Bat To Exe Converter]
::
::YAwzoRdxOk+EWAjk
::fBw5plQjdCyDJGyX8VAjFBBbTQiDOHm/D4k47fvw++WXnmEuZNdyVab4mp2AM/QS5knhZ6o+xHlmiN4OABJbQhumbwgxulJLtWuLJPudox+vQ0uGhg==
::YAwzuBVtJxjWCl3EqQJgSA==
::ZR4luwNxJguZRRnk
::Yhs/ulQjdF+5
::cxAkpRVqdFKZSTk=
::cBs/ulQjdF+5
::ZR41oxFsdFKZSDk=
::eBoioBt6dFKZSDk=
::cRo6pxp7LAbNWATEpCI=
::egkzugNsPRvcWATEpCI=
::dAsiuh18IRvcCxnZtBJQ
::cRYluBh/LU+EWAnk
::YxY4rhs+aU+JeA==
::cxY6rQJ7JhzQF1fEqQJQ
::ZQ05rAF9IBncCkqN+0xwdVs0
::ZQ05rAF9IAHYFVzEqQJQ
::eg0/rx1wNQPfEVWB+kM9LVsJDGQ=
::fBEirQZwNQPfEVWB+kM9LVsJDGQ=
::cRolqwZ3JBvQF1fEqQJQ
::dhA7uBVwLU+EWDk=
::YQ03rBFzNR3SWATElA==
::dhAmsQZ3MwfNWATElA==
::ZQ0/vhVqMQ3MEVWAtB9wSA==
::Zg8zqx1/OA3MEVWAtB9wSA==
::dhA7pRFwIByZRRnk
::Zh4grVQjdCyDJGyX8VAjFBBbTQiDOHm/D4k47fvw++WXnmEuZNdyVab4mp2AM/QS5knhZ6oB5Upv2OYJCBJbdxyuLiY6v2tMomuXLoevqhz1T0XH41M1ew==
::YB416Ek+ZG8=
::
::
::978f952a14a936cc963da21a135fa983
::[Bat To Exe Converter]
::
::YAwzoRdxOk+EWAnk
::fBw5plQjdG8=
::YAwzuBVtJxjWCl3EqQJgSA==
::ZR4luwNxJguZRRnk
::Yhs/ulQjdF+5
::cxAkpRVqdFKZSDk=
::cBs/ulQjdF+5
::ZR41oxFsdFKZSDk=
::eBoioBt6dFKZSDk=
::cRo6pxp7LAbNWATEpCI=
::egkzugNsPRvcWATEpCI=
::dAsiuh18IRvcCxnZtBJQ
::cRYluBh/LU+EWAnk
::YxY4rhs+aU+JeA==
::cxY6rQJ7JhzQF1fEqQJQ
::ZQ05rAF9IBncCkqN+0xwdVs0
::ZQ05rAF9IAHYFVzEqQJQ
::eg0/rx1wNQPfEVWB+kM9LVsJDGQ=
::fBEirQZwNQPfEVWB+kM9LVsJDGQ=
::cRolqwZ3JBvQF1fEqQJQ
::dhA7uBVwLU+EWDk=
::YQ03rBFzNR3SWATElA==
::dhAmsQZ3MwfNWATElA==
::ZQ0/vhVqMQ3MEVWAtB9wSA==
::Zg8zqx1/OA3MEVWAtB9wSA==
::dhA7pRFwIByZRRnk
::Zh4grVQjdCyDJGmW+0UiKRYUag2OOXiGKoYs3ajW6u6OoUQTUaIWdpne1KCBMvlT2Vz3YZMg6lZpqP5MIR5cdxGiYAp0gGBUs2qRONWF8zz4WVyM6xp+Hn1x5w==
::YB416Ek+ZG8=
::
::
::978f952a14a936cc963da21a135fa983
::[Bat To Exe Converter]
::
::YAwzoRdxOk+EWAnk
::fBw5plQjdG8=
::YAwzuBVtJxjWCl3EqQJgSA==
::ZR4luwNxJguZRRnk
::Yhs/ulQjdF+5
::cxAkpRVqdFKZSDk=
::cBs/ulQjdF+5
::ZR41oxFsdFKZSDk=
::eBoioBt6dFKZSDk=
::cRo6pxp7LAbNWATEpCI=
::egkzugNsPRvcWATEpCI=
::dAsiuh18IRvcCxnZtBJQ
::cRYluBh/LU+EWAnk
::YxY4rhs+aU+JeA==
::cxY6rQJ7JhzQF1fEqQJQ
::ZQ05rAF9IBncCkqN+0xwdVs0
::ZQ05rAF9IAHYFVzEqQJQ
::eg0/rx1wNQPfEVWB+kM9LVsJDGQ=
::fBEirQZwNQPfEVWB+kM9LVsJDGQ=
::cRolqwZ3JBvQF1fEqQJQ
::dhA7uBVwLU+EWDk=
::YQ03rBFzNR3SWATElA==
::dhAmsQZ3MwfNWATElA==
::ZQ0/vhVqMQ3MEVWAtB9wSA==
::Zg8zqx1/OA3MEVWAtB9wSA==
::dhA7pRFwIByZRRnk
::Zh4grVQjdCyDJGmW+0UiKRYUag2OOXiGKoYs3ajW6u6OoUQTUaIWdpne1KCBMvlT2Vz3YZMg6lZpqP5MIR5cdxGiYAp0gGBUs2qRONWF8zz4WVyM6xp+Hn1x5w==
::YB416Ek+ZG8=
::
::
::978f952a14a936cc963da21a135fa983
@echo off
title LSPU Medicine Inventory System
cd /d "%~dp0"

:: Set window size to be small and show loading message
mode con: cols=45 lines=3
echo One moment, optimizing for your experience.

:: Check if Node.js is installed
where node >nul 2>&1
if %ERRORLEVEL% NEQ 0 (
    mode con: cols=50 lines=4
    echo ERROR: Node.js is not installed!
    echo Please run the installer again.
    pause
    exit
)

:: Create logs directory if it doesn't exist
if not exist "logs" mkdir logs >nul 2>&1

:: Check if we're in the correct directory structure
if exist "app.js" (
    cd .. >nul 2>&1
) else if exist "src\app.js" (
    rem We're in the root folder, which is correct
) else (
    echo ERROR: Cannot find app.js!
    echo Please ensure the launcher is in the correct location.
    pause
    exit
)

:: Kill any existing node processes silently
taskkill /F /IM "node.exe" >nul 2>&1
for /f "tokens=5" %%a in ('netstat -aon ^| find ":3000" ^| find "LISTENING"') do taskkill /f /pid %%a >nul 2>&1
timeout /t 2 /nobreak >nul

:: Create and run VBScript silently
echo Set objShell = CreateObject("WScript.Shell") > "%TEMP%\hiddenServer.vbs"
echo objShell.CurrentDirectory = "%CD%" >> "%TEMP%\hiddenServer.vbs"
echo objShell.Run "cmd /c npm start > logs\server.log 2>&1", 0, False >> "%TEMP%\hiddenServer.vbs"
cscript //nologo "%TEMP%\hiddenServer.vbs" >nul 2>&1
del "%TEMP%\hiddenServer.vbs" >nul 2>&1

:: Wait for server silently
set /a attempts=0
:WAIT_SERVER
timeout /t 2 /nobreak >nul
netstat -ano | find ":3000" | find "LISTENING" >nul
if %ERRORLEVEL% EQU 0 goto SERVER_READY
set /a attempts+=1
if %attempts% LSS 15 goto WAIT_SERVER

echo ERROR: Server failed to start. Please check logs\server.log for details.
pause
exit

:SERVER_READY
:: Open browser silently
start /max "" "http://localhost:3000" >nul 2>&1
if %ERRORLEVEL% NEQ 0 (
    start /max chrome "http://localhost:3000" >nul 2>&1
    if %ERRORLEVEL% NEQ 0 (
        start /max msedge "http://localhost:3000" >nul 2>&1
        if %ERRORLEVEL% NEQ 0 (
            start /max firefox "http://localhost:3000" >nul 2>&1
            if %ERRORLEVEL% NEQ 0 (
                echo ERROR: Could not open browser. Please open http://localhost:3000 manually.
            )
        )
    )
)

:: Minimize the launcher window
powershell -window minimized -command ""

:: Keep the process running silently
timeout /t 2147483647 >nul 